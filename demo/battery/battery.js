var battery=navigator.battery||navigator.mozBattery||navigator.webkitBattery,$body=$(document.body),$indicator=$(".indicator"),$surface=$(".indicator-surface"),$capacity=$(".indicator-capacity"),$level=$(".level"),$status=$(".status");function onResize(){var a=window.screen;$body.toggleClass("rotate",a.availWidth>a.availHeight)}window.addEventListener("resize",onResize);onResize();var capacityMinY=78,capacityMaxY=378;
function updateIndicator(a){a=capacityMaxY-(capacityMaxY-capacityMinY)*a;$capacity[0].style.cssText="-webkit-mask-position:0 "+a+"px";$surface.css("top",a-26+"px")}var supportedBattery=!1,lastCharging,lastLevel=0,lastTime=0;
function updateCharging(){var a=battery.charging,c=battery.level,d=battery.chargingTime,e=battery.dischargingTime,g=Math.floor(100*c)+"%",b;if(supportedBattery)if(a&&1===c)b="\u7535\u6c60\u5df2\u7ecf\u5145\u6ee1";else if(b=(a?"\u5145\u7535\u4e2d":"\u653e\u7535\u4e2d")+"<br>",a!==lastCharging&&(lastCharging=a,lastTime=lastLevel=0),0===lastLevel||lastLevel===c)lastLevel=c,lastTime=new Date,b+="...";else{var f=Math.abs((c-lastLevel)/((new Date-lastTime)/1E3));a?(a=isFinite(d)&&0<d?d/60:(1-c)/f/60,b+=
"\u7ea6"+Math.round(a)+"\u5206\u949f\u5145\u6ee1"):(a=isFinite(e)&&0<e?e/60:c/f/60,b+="\u7ea6"+Math.round(a)+"\u5206\u949f\u7528\u5b8c")}else b="\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u7535\u6c60\u7535\u91cf\u68c0\u6d4b<br>\u968f\u673a\u663e\u793a\u7535\u91cf\uff0c\u4e0e\u8bbe\u5907\u5b9e\u9645\u5269\u4f59\u7535\u91cf\u65e0\u5173";$level.html(g);$status.html(b);updateIndicator(c)}
battery?(supportedBattery=!0,battery.addEventListener("chargingchange",updateCharging),battery.addEventListener("levelchange",updateCharging),battery.addEventListener("chargingtimechange",updateCharging),battery.addEventListener("dischargingtimechange",updateCharging)):(battery={charging:!1,level:Math.random()},updateCharging());
